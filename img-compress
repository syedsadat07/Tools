<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 
      ================================================================
      SEO (Search Engine Optimization) Meta Tags
      ================================================================
    -->
    <title>Free Online Image Compressor - Optimize JPEG/PNG Size</title>
    <meta name="description" content="Easily compress your images online. Our free tool helps you reduce the file size of JPEG and PNG images with an adjustable quality slider. Fast, free, and secure.">
    <meta name="keywords" content="image compressor, compress image, image optimizer, reduce image size, compress jpeg, compress png, free image compressor, image size reducer">
    
    <!-- 
      ================================================================
      Tailwind CSS for Styling
      ================================================================
    -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 
      ================================================================
      Google Font (Inter)
      ================================================================
    -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- 
      ================================================================
      Adsterra Ad Code (Integration Script)
      ================================================================
      NOTE: You will need to replace the placeholder script link
      and ad unit IDs with your actual codes from Adsterra.
    -->
    <!-- 
      <script async="async" data-cfasync="false" src="//pl12345678.com/your-unique-ad-code.js"></script>
    -->

    <!-- 
      ================================================================
      Tailwind Dark Mode Configuration
      ================================================================
      This MUST come BEFORE loading the main Tailwind script.
      It tells Tailwind to use the 'class' strategy for dark mode.
    -->
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            },
          }
        }
      }
    </script>

    <style>
        /* Custom styles to enhance Tailwind */
        body {
            /* font-family is now handled by Tailwind config */
        }
        
        /* Custom file input */
        .file-input-label {
            transition: all 0.3s ease;
        }
        .file-input-label:hover {
            background-color: #f9fafb; /* A lighter gray on hover */
            border-color: #3b82f6; /* Blue border on hover */
        }

        /* Custom range slider */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #e5e7eb; /* gray-200 */
            border-radius: 9999px;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }
        /* Add dark mode support for slider */
        .dark input[type="range"] {
            background: #374151; /* gray-700 */
        }
        input[type="range"]:hover {
            opacity: 1;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3b82f6; /* blue-500 */
            cursor: pointer;
            border-radius: 50%;
        }
        /* Add dark mode support for slider thumb */
        .dark input[type="range"]::-webkit-slider-thumb {
            background: #60a5fa; /* blue-400 */
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3b82f6; /* blue-500 */
            cursor: pointer;
            border-radius: 50%;
        }
        /* Add dark mode support for slider thumb */
        .dark input[type="range"]::-moz-range-thumb {
            background: #60a5fa; /* blue-400 */
        }
        
        /* Ad placeholder styling */
        .ad-placeholder {
            background-color: #f3f4f6;
            border: 2px dashed #d1d5db;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            min-height: 90px;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-200 transition-colors duration-300 font-sans">

    <!-- Header -->
    <header class="bg-white shadow-sm dark:bg-gray-800 dark:shadow-lg dark:shadow-gray-700/10">
        <div class="container mx-auto px-4 py-4 md:py-6 relative">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-600 dark:text-blue-400 text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="inline-block w-8 h-8 md:w-10 md:h-10 mr-2 -mt-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                Ultra Image Compressor
            </h1>
            <p class="text-center text-gray-500 dark:text-gray-400 mt-1 text-base md:text-lg">Reduce image file sizes instantly without losing quality.</p>
            
            <!-- Theme Toggle Button -->
            <button id="themeToggleBtn" class="absolute top-1/2 -translate-y-1/2 right-4 md:right-6 p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <!-- Sun Icon -->
                <svg id="lightIcon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <!-- Moon Icon -->
                <svg id="darkIcon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>

        </div>
    </header>

    <!-- Adsterra Top Banner Ad Space -->
    <div class="container mx-auto px-4 mt-6">
        <div class="ad-placeholder banner-ad-top w-full h-[100px] md:h-[90px] dark:bg-gray-800 dark:border-gray-700 dark:text-gray-500">
            <!-- 
              ================================================================
              Adsterra 728x90 Banner Ad Code Goes Here
              ================================================================
              Example:
              <div class="ad-unit" data-ad-unit-id="YOUR_ADSTERRA_BANNER_ID"></div>
            -->
            Adsterra 728x90 Banner Ad Space
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto p-4 mt-6">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8">

            <!-- Control Panel (Left/Top) -->
            <div class="lg:col-span-2 bg-white p-6 md:p-8 rounded-xl shadow-lg dark:bg-gray-800">
                
                <!-- 1. Upload Section -->
                <section>
                    <h2 class="text-2xl font-semibold mb-4 text-gray-800 dark:text-gray-100">1. Upload Your Image</h2>
                    <label for="fileInput" class="file-input-label flex flex-col items-center justify-center w-full h-48 md:h-64 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-white dark:bg-gray-800 dark:border-gray-600 dark:hover:border-blue-500 dark:hover:bg-gray-700">
                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                            <svg class="w-10 h-10 mb-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                            <p class="mb-2 text-sm text-gray-500 dark:text-gray-400"><span class="font-semibold">Click to upload</span> or drag and drop</p>
                            <p class="text-xs text-gray-500 dark:text-gray-400">PNG, JPG, or WEBP</p>
                            <p id="fileName" class="text-sm text-blue-600 font-medium mt-2"></p>
                        </div>
                        <input id="fileInput" type="file" class="hidden" accept="image/png, image/jpeg, image/webp" />
                    </label>
                </section>

                <!-- 2. Settings Section -->
                <section class="mt-8">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-800 dark:text-gray-100">2. Adjust Compression</h2>
                    <div class="flex justify-between items-center mb-2">
                        <label for="compressionSlider" class="text-base font-medium text-gray-700 dark:text-gray-300">Quality Level:</label>
                        <span id="sliderValue" class="text-lg font-bold text-blue-600 dark:text-blue-400">80%</span>
                    </div>
                    <input id="compressionSlider" type="range" min="0" max="100" value="80" class="w-full">
                    <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1">
                        <span>Low Quality</span>
                        <span>High Quality</span>
                    </div>
                </section>

                <!-- 3. Action Button -->
                <section class="mt-8">
                    <button id="compressButton" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg text-lg hover:bg-blue-700 transition duration-300 shadow-md disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        Compress Image
                    </button>
                    <p id="loadingMessage" class="text-center text-gray-500 dark:text-gray-400 mt-4" style="display: none;">
                        Compressing, please wait...
                    </p>
                </section>

            </div>

            <!-- Sidebar (Right/Bottom) -->
            <aside class="lg:col-span-1 space-y-6">
                <!-- Adsterra Square/Sidebar Ad Space -->
                <div class="bg-white p-4 rounded-xl shadow-lg dark:bg-gray-800">
                    <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-100">Advertisement</h3>
                    <div class="ad-placeholder square-ad-sidebar w-full h-[250px] md:h-[200px] lg:h-[250px] dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400">
                        <!-- 
                          ================================================================
                          Adsterra 300x250 Ad Code Goes Here
                          ================================================================
                          Example:
                          <div class="ad-unit" data-ad-unit-id="YOUR_ADSTERRA_SQUARE_ID"></div>
                        -->
                        Adsterra 300x250 Ad Space
                    </div>
                </div>

                <!-- How It Works -->
                <div class="bg-white p-6 rounded-xl shadow-lg dark:bg-gray-800">
                    <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-100">How It Works</h3>
                    <ol class="list-decimal list-inside text-gray-600 dark:text-gray-300 space-y-2">
                        <li>Upload your JPEG, PNG, or WEBP image.</li>
                        <li>Adjust the quality slider (lower = smaller file).</li>
                        <li>Click "Compress Image".</li>
                        <li>Preview and download your optimized image!</li>
                    </ol>
                </div>
            </aside>

        </div>

        <!-- 4. Preview and Download Section -->
        <section id="previewSection" class="mt-6 md:mt-8 bg-white p-6 md:p-8 rounded-xl shadow-lg dark:bg-gray-800" style="display: none;">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800 dark:text-gray-100 text-center">3. Compare & Download</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                
                <!-- Original Image -->
                <div class="border border-gray-200 rounded-lg p-4 dark:border-gray-700">
                    <h3 class="text-xl font-semibold text-center mb-3 dark:text-gray-200">Original Image</h3>
                    <img id="originalImage" src="" alt="Original user-uploaded image" class="w-full h-auto max-h-96 object-contain rounded-md bg-gray-100 dark:bg-gray-700">
                    <p id="originalSize" class="text-center font-medium text-lg mt-3 dark:text-gray-200">Size: 0 KB</p>
                </div>
                
                <!-- Compressed Image -->
                <div class="border border-gray-200 rounded-lg p-4 dark:border-gray-700">
                    <h3 class="text-xl font-semibold text-center mb-3 dark:text-gray-200">Compressed Image</h3>
                    <img id="compressedImage" src="" alt="Compressed and optimized image" class="w-full h-auto max-h-96 object-contain rounded-md bg-gray-100 dark:bg-gray-700">
                    <p id="compressedSize" class="text-center font-medium text-lg mt-3 text-green-600 dark:text-green-400">Size: 0 KB</p>
                    <p id="savings" class="text-center font-bold text-xl mt-2 text-green-700 dark:text-green-500"></p>
                </div>
            </div>

            <!-- Download Button -->
            <div class="text-center mt-8">
                <a id="downloadButton" href="#" download="compressed-image.jpg" class="inline-block bg-green-600 text-white font-bold py-3 px-10 rounded-lg text-lg hover:bg-green-700 transition duration-300 shadow-md" style="display: none;">
                    Download Compressed Image
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="text-center py-8 mt-10 bg-gray-100 border-t border-gray-200 dark:bg-gray-800 dark:border-gray-700">
        <p class="text-gray-500 dark:text-gray-400">&copy; 2025 e-toolshub. All rights reserved.</p>
        <p class="text-gray-500 dark:text-gray-400 text-sm mt-1">A free tool to make your website faster.</p>
    </footer>

    <!-- 
      ================================================================
      JavaScript for Functionality
      ================================================================
    -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Get all DOM elements
            const fileInput = document.getElementById('fileInput');
            const fileNameDisplay = document.getElementById('fileName');
            const compressionSlider = document.getElementById('compressionSlider');
            const sliderValueDisplay = document.getElementById('sliderValue');
            const compressButton = document.getElementById('compressButton');
            const previewSection = document.getElementById('previewSection');
            const originalImage = document.getElementById('originalImage');
            const compressedImage = document.getElementById('compressedImage');
            const originalSize = document.getElementById('originalSize');
            const compressedSize = document.getElementById('compressedSize');
            const savings = document.getElementById('savings');
            const downloadButton = document.getElementById('downloadButton');
            const loadingMessage = document.getElementById('loadingMessage');
            const themeToggleBtn = document.getElementById('themeToggleBtn');
            const lightIcon = document.getElementById('lightIcon');
            const darkIcon = document.getElementById('darkIcon');

            let originalFile = null;
            let originalImageURL = null;

            // --- 0. Theme Handling ---
            
            // Function to apply the saved theme on page load
            function applyTheme() {
                if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    document.documentElement.classList.add('dark');
                    darkIcon.classList.remove('hidden');
                    lightIcon.classList.add('hidden');
                } else {
                    document.documentElement.classList.remove('dark');
                    lightIcon.classList.remove('hidden');
                    darkIcon.classList.add('hidden');
                }
            }

            // Theme toggle button event listener
            themeToggleBtn.addEventListener('click', () => {
                const isDark = document.documentElement.classList.toggle('dark');
                if (isDark) {
                    localStorage.theme = 'dark';
                    darkIcon.classList.remove('hidden');
                    lightIcon.classList.add('hidden');
                } else {
                    localStorage.theme = 'light';
                    lightIcon.classList.remove('hidden');
                    darkIcon.classList.add('hidden');
                }
            });

            // Apply theme as soon as the DOM is loaded
            applyTheme();

            // --- 1. Handle File Upload ---
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) {
                    return;
                }
                
                // Check file type
                if (!['image/jpeg', 'image/png', 'image/webp'].includes(file.type)) {
                    // Using a simple message box instead of alert()
                    showModal('Error', 'Invalid file type. Please upload a JPG, PNG, or WEBP file.');
                    return;
                }

                originalFile = file;
                fileNameDisplay.textContent = file.name;
                
                // Create a FileReader to show preview
                const reader = new FileReader();
                reader.onload = (event) => {
                    originalImageURL = event.target.result;
                    originalImage.src = originalImageURL;
                    originalSize.textContent = `Size: ${formatBytes(file.size)}`;
                    compressButton.disabled = false;
                    previewSection.style.display = 'block';
                    // Reset compressed view
                    compressedImage.src = '';
                    compressedSize.textContent = 'Size: ...';
                    savings.textContent = '';
                    downloadButton.style.display = 'none';
                };
                reader.readAsDataURL(file);
            });

            // --- 2. Update Slider Value Display ---
            compressionSlider.addEventListener('input', (e) => {
                sliderValueDisplay.textContent = `${e.target.value}%`;
            });

            // --- 3. Handle Compression ---
            compressButton.addEventListener('click', () => {
                if (!originalFile || !originalImageURL) {
                    showModal('Error', 'Please upload an image first.');
                    return;
                }

                // Show loading state
                compressButton.disabled = true;
                loadingMessage.style.display = 'block';
                compressedImage.src = 'https://placehold.co/600x400/f3f4f6/6b7280?text=Compressing...';

                const quality = parseInt(compressionSlider.value) / 100;
                
                // Use an Image object to get natural dimensions
                const img = new Image();
                img.src = originalImageURL;
                img.onload = () => {
                    // Create canvas
                    const canvas = document.createElement('canvas');
                    canvas.width = img.naturalWidth;
                    canvas.height = img.naturalHeight;
                    const ctx = canvas.getContext('2d');
                    
                    // Draw image
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    
                    // Get compressed data URL
                    // Note: 'image/jpeg' and 'image/webp' support quality. 'image/png' does not.
                    // We will compress to JPEG for quality control, as this is standard.
                    const outputFormat = 'image/jpeg';
                    const compressedDataUrl = canvas.toDataURL(outputFormat, quality);
                    
                    compressedImage.src = compressedDataUrl;

                    // Calculate compressed size
                    const compressedFile = dataURLtoFile(compressedDataUrl, 'compressed-image.jpg');
                    const compressedFileSize = compressedFile.size;
                    
                    compressedSize.textContent = `Size: ${formatBytes(compressedFileSize)}`;
                    
                    // Calculate and display savings
                    const originalFileSize = originalFile.size;
                    const sizeDifference = originalFileSize - compressedFileSize;
                    if (sizeDifference > 0) {
                        const percentSaved = ((sizeDifference / originalFileSize) * 100).toFixed(1);
                        savings.textContent = `Saved ${formatBytes(sizeDifference)} (${percentSaved}%)`;
                    } else {
                        savings.textContent = 'File size may have increased (try lower quality)';
                    }
                    
                    // Setup download button
                    downloadButton.href = compressedDataUrl;
                    downloadButton.download = `compressed-${getFileName(originalFile.name)}.jpg`;
                    downloadButton.style.display = 'inline-block';
                    
                    // Hide loading state
                    compressButton.disabled = false;
                    loadingMessage.style.display = 'none';
                };
                
                img.onerror = () => {
                    showModal('Error', 'Could not load the image for compression.');
                    compressButton.disabled = false;
                    loadingMessage.style.display = 'none';
                };
            });
            
            // --- Helper Functions ---
            
            // Format bytes to KB, MB
            function formatBytes(bytes, decimals = 2) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const dm = decimals < 0 ? 0 : decimals;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
            }

            // Get file name without extension
            function getFileName(fileName) {
                return fileName.split('.').slice(0, -1).join('.');
            }

            // Convert Data URL to File object
            function dataURLtoFile(dataurl, filename) {
                let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
                    bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
                while(n--){
                    u8arr[n] = bstr.charCodeAt(n);
                }
                return new File([u8arr], filename, {type:mime});
            }

            // Simple modal instead of alert()
            function showModal(title, message) {
                // Check if a modal already exists
                if (document.getElementById('customModal')) {
                    return;
                }

                const modalBackdrop = document.createElement('div');
                modalBackdrop.id = 'customModal';
                modalBackdrop.className = 'fixed inset-0 bg-gray-900 bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center z-50';
                
                const modalContent = document.createElement('div');
                modalContent.className = 'bg-white rounded-lg shadow-xl p-6 w-11/12 md:w-1/3 dark:bg-gray-800';
                
                const modalTitle = document.createElement('h3');
                modalTitle.className = 'text-xl font-bold mb-4 dark:text-gray-100';
                modalTitle.textContent = title;
                
                const modalMessage = document.createElement('p');
                modalMessage.className = 'text-gray-700 mb-6 dark:text-gray-300';
                modalMessage.textContent = message;
                
                const closeButton = document.createElement('button');
                closeButton.className = 'w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition dark:hover:bg-blue-700';
                closeButton.textContent = 'OK';
                
                closeButton.onclick = () => {
                    document.body.removeChild(modalBackdrop);
                };
                
                modalContent.appendChild(modalTitle);
                modalContent.appendChild(modalMessage);
                modalContent.appendChild(closeButton);
                modalBackdrop.appendChild(modalContent);
                document.body.appendChild(modalBackdrop);
            }
        });
    </script>

</body>
</html>


